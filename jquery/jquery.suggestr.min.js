// Suggestr - the dead simple autocompleter
//
// Copyright (c) 2011, Honza Pokorny
// Suggestr may be freely distributed under the BSD license.
// https://github.com/honza/suggestr.js
(function(a){var b,c,d,e;b={up:38,down:40,enter:13},c={listStyle:"none",backgroundColor:"#ececec"},d={listStyle:"none",backgroundColor:"#fff"},e={width:"200px",position:"absolute"},a.fn.suggestr=function(f){function j(e){var f,h;f=g.data("active"),e==b.up?h=f-1:h=f+1,-1<h&&h<g.children().length&&(g.children().each(function(b,c){a(c).css(d)}),a(g.children()[h]).css(c),g.data("active",h))}function k(){g.data("active",0),g.children().remove()}var g,h,i;h=this,g=document.getElementById("suggestr-div")||a('<div id="suggestr-div"></div>'),g.css(e),g.data("active",0),g.delegate("li","mouseover",function(){a(this).css(c)}),g.delegate("li","mouseout",function(){a(this).css(d)}),g.delegate("li","click",function(){var b=a(this).text();h.val(b),k()}),this.blur(function(a){g.remove()}),this.keydown(function(c){if(c.keyCode==b.enter){var d=a(g.children()[g.data("active")]).text();return h.val(d),k(),c.preventDefault?c.preventDefault():c.returnValue=!1,c.stopPropagation&&c.stopPropagation(),c.cancelBubble&&(c.cancelBubble=!0),!1}if(c.keyCode==b.up||c.keyCode==b.down)return j(c.keyCode),c.preventDefault?c.preventDefault():c.returnValue=!1,c.stopPropagation&&c.stopPropagation(),c.cancelBubble&&(c.cancelBubble=!0),!1}),this.keyup(function(e){if(e.keyCode==b.enter)return;if(e.keyCode==b.up||e.keyCode==b.down)return;g.children().remove(),i=h.val().toLowerCase();if(!i.length)return;a.each(f,function(b,c){if(c.toLowerCase().indexOf(i)>-1){var e=new RegExp("(?![^&;]+;)(?!<[^<>]*)("+i+")(?![^<>]*>)(?![^&;]+;)","gi");c=c.replace(e,"<strong>$1</strong>");var f=a("<li>"+c+"</li>");a(f).css(d),g.append(f)}}),h.after(g),g.children().first().css(c)})}})(jQuery);